<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Thursday, March 10, 2022, 7:58 PM -->
<!-- MuClient version 5.06 -->

<!-- Plugin "Moku_Timers" generated by Plugin Wizard -->

<muclient>
<plugin
   name="Moku_Timers"
   author="clafoutis"
   id="9bfdfb563323c5013a147c64"
   language="Lua"
   save_state="y"
   date_written="2022-03-10 19:56:46"
   requires="5.06"
   version="1.0"
   >

</plugin>

<!--  Get our standard constants -->

<include name="constants.lua"/>

<!--  Variables  -->

<variables>

</variables>

<!--  Triggers  -->

<triggers>

  <trigger
    enabled="y"
    keep_evaluating="y"
    match="Beginning Control Shell*"
    regexp="y"
    send_to="12"
    sequence="100"
  >
    <send>
	  EnableTimer ("Timer_Display", false)
	</send>
  </trigger>

  <trigger
    enabled="y"
    keep_evaluating="y"
    match="Exiting Control Shell\.\.\."
    regexp="y"
    send_to="12"
    sequence="100"
  >
    <send>
	  EnableTimer ("Timer_Display", true)
	</send>
  </trigger>
  
  <trigger
    enabled="y"
    keep_evaluating="y"
    match="You apply the salve and release toxins from your body\."
    regexp="y"
    send_to="12"
    sequence="100"
  >
    <send>
	  EnableTimer ("Salve_Timer", true)
	  ResetTimer("Salve_Timer")
	</send>
  </trigger>

</triggers>

<!--  Aliases  -->

<aliases>

</aliases>

<!-- timers -->

<timers>

  <timer
    name="Salve_Timer"
    enabled="n"
    minute="10"
    second="0.00"
    offset_second="0.00"
    send_to="12"
  >
    <send>
	  EnableTimer ("Salve_Timer", false)
    </send>
  </timer>

  <timer
    name="Timer_Display"
    enabled="y"
    second="1.00"
    offset_second="0.00"
    send_to="12"
  >
    <send>
      DisplayTitle ()
	  DrawingSalveTimer ()
    </send>
  </timer>

</timers>

<!--  Script  -->

<script>

  <![CDATA[

    function OnPluginInstall (s)

      local openedTargetterOk = world.Open ("worlds\\\\Space_Targetter.MCL")
      local SWmudOpened = world.Open ("worlds\\\\SWmud.MCL") -- puts focus back on main window
	  
      local t = GetWorld ("Space_Targetter")  -- get "Space_Targetter" world	  
	  
      if openedTargetterOk == true then
        t:DeleteOutput()
        t:Note ('Moku_Timers Plugin installed')
      else
	    Note ("Moku_Timers Did Not Load")
	  end	  

    end -- function OnPluginInstall

    function DisplayTitle ()
	
      local t = GetWorld ("Space_Targetter")  -- get "Space_Targetter" world
	  
      t:DeleteOutput ()
      t:ColourNote (
        "#35A5CE", "black", "                Timers:")
	  t:ColourNote ("green", "black", "---------------------------------------")	
      t:ColourNote (
	    "gray", "black", "Timers: ",
        "#C0C0C0", "black", "Accumulated xp: ",
        "cyan", "black", "test")

    end -- function DisplayTitle
	
	function DrawingSalveTimer ()

      local t = GetWorld ("Space_Targetter")  -- get "Space_Targetter" worlds\\\\SWmud
	  
        local secRemain = GetTimerInfo ("Salve_Timer", 13)
		local timerOn = GetTimerInfo ("Salve_Timer", 6)

        if timerOn == true then
          secRemain = math.floor(secRemain + 0.5)
          local min = math.floor(secRemain / 60)
          local sec = secRemain - (min * 60)

          if sec < 10 then
            sec = "0" .. sec
          end

          if min < 10 then
            min = " " .. min
          end

          t:ColourNote(
            "gray", "black", "drawing salve: ",
            "cornflowerblue", "black", min,
            "cornflowerblue", "black", ":",
            "cornflowerblue", "black", sec)
		end
	  
    end -- function DrawingSalveTimer
	
  ]]>

</script>

</muclient>
